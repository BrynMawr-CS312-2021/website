include::header.adoc[]

:title: Assignment 4: Give it your best PLY
:Author Initials: ASN
:Date:    2020-02-07
:Revision: 0.1

= {title}

**Due Monday, April 19, before midnight**

The goals for this assignment are:

* Implement an interactive model viewer using openGL 4.0+
* Read and display meshes in PLY file format
* Implement blinn-phong materials using shaders
* Try importing your own models and/or implementing your own shaders

:sectnums:

= Getting started

Fork the repository at https://github.com/BrynMawr-CS312-2021/mesh-viewer

Follow the instructions in `Readme.md` to build and run the code.

= Getting started

We will be using link:https://www.khronos.org/files/opengl4-quick-reference-card.pdf[OpenGL] 
to build our viewer.  

Your basecode uses the link:https://github.com/g-truc/glm/blob/master/manual.md[GLM math library] 
for vectors, points, and colors (all have type glm::vec3)

Make sure that you can build and run the examples from lecture.
The examples from lecture can be found link:https://github.com/BrynMawr-CS312-2021/opengl-examples[here].

= Mesh viewer

Look at file, `main.cpp`. 

When you run this program, you should see:

image::A04/todo.png[]

== Meshes

Implement a class `Mesh` that is capable of loading link:http://paulbourke.net/dataformats/ply/[PLY files].

**Loading PLY files**

[source]
----
ply
format ascii 1.0
element vertex 4
property float32 x
property float32 y
property float32 z
element face 3
property list uint8 int32 vertex_indices
end_header
-0.001 0.002 0.070
-0.009 0.044 0.088
-0.01 0.033 0.09
-0.023 0.031 0.082
3 0 1 2
3 2 3 1
3 3 0 2
----

image::A04/PLYFileAdvice-ExtSchool.png[]

== User controls

*Changing models*

Your project contains 43 PLY files in the `/models` directory. The user
should be able to change the currently viewed model using the keyboard.

* n or N should display the next model
* p or P should display the previous model

*Initializing the view*

Each model has a different size. Compute the bounding box for each model and 
use it to initialize the camera and projection matrix so that each model fits into the 
view volume without clipping.

*Camera controls*

Implement an orbit camera for and keyboard controls for your viewer. This behavior 
is equivalent to rotating the camera in blender using the middle mouse button.

* Click and dragging the mouse left and right should rotate the camera horizontally
* Click and dragging the mouse up and down should rotate the camera vertically
* SHIFT+Click and dragging the mouse should translate the camera forward and back

NOTE: For a single object, we can implement the same behavior by rotating the model, 
instead of the camera. However, an orbit camera is something you can re-use in other 
applications! 

== Blinn-Phong shading

Implement Blinn-Phong shaders, `blinn-phong.vert` and `blinn-phong.frag`. 

You will notice that our models have a faceted appearance. 

todo:image

The issue is that each triangle has its own normal. For the model to look 
smooth, we need to average the normal at each vertex. 
Note that there's a fast and slow way to implement this 
(credit: Harvard Extension School, Fall 2002):

[source]
----
// The slow way
For each vertex // main outer loop
   // this means searching through all triangles every iteration!
   Find triangles that hook up to this vertex // time consuming!
   Get average of those, and assign to this vertex

// A faster way
For each triangle // main outer loop
   For each of 3 vertices
       vertex.normal += triangle.normal
For each vertex
   vertex.normal.normalize()
----

The above code assumes that the triangle normals have been precalculated and
that the vertex normals start at zero. We also assume that triangle normals
are stored separated from vertex normals.

== Unique features

Add *at least one* unique model, feature, or shading effect to your viewer. 

You can export PLY files from Blender. Try finding a free model online and
converting to PLY, or even create a model of your own! Be sure to credit the
artist if you use someone else's work.

Ideas for unique features:

* Display the frame rate
* Compute and display the time needed to load each model
* Implement your own shader: toon shading
* Implement your own shader: procedural color patterns
* Implement your own shader: jitter colors or normals to create different effects
* Use textures to create a unique shader. Or load a model with texture coordinates and map a texture to the model.
* Animate the vertices of the model in your vertex shader

= Update Readme.md

Update `Readme.md` to include documentation on your unique features and images created with your mesh-viewer.

= What to hand in

. Your code. Make sure your code is checked into github
. One or more images created using your software
. Update `Readme.md` so it includes a writeup of the features your application supports. Make sure to include images. Be sure to point out any original features that you implement.